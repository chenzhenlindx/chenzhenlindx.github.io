<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="Android开发者">
<meta property="og:type" content="website">
<meta property="og:title" content="chenzhenlindx的博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="chenzhenlindx的博客">
<meta property="og:description" content="Android开发者">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="chenzhenlindx的博客">
<meta name="twitter:description" content="Android开发者">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>chenzhenlindx的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>
	<a href="https://github.com/chenzhenlindx"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">chenzhenlindx的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">静待花开</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/22/Android String.xml 相关/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/22/Android String.xml 相关/" itemprop="url">Android String.xml 相关</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-22T11:33:04+08:00">
                2018-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/重构/" itemprop="url" rel="index">
                    <span itemprop="name">重构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="动态显示"><a href="#动态显示" class="headerlink" title="动态显示"></a>动态显示</h4><blockquote>
<p>%n$ms：代表输出的是字符串，n代表是第几个参数，设置m的值可以在输出之前放置空格<br>%n$md：代表输出的是整数，n代表是第几个参数，设置m的值可以在输出之前放置空格<br>%n$mf：代表输出的是浮点数，n代表是第几个参数，设置m的值可以控制小数位数，如m=2.2时，输出格式为00.00</p>
<h5 id="1-s"><a href="#1-s" class="headerlink" title="%1$s"></a>%1$s</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"loading"</span>&gt;</span>离下班回家还剩%1$s分钟<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String temp = getResources().getString(R.string.loading);</span><br><span class="line">String timeTip = String.format(temp,<span class="number">38</span>);</span><br></pre></td></tr></table></figure>
<p>结果：离下班回家还剩<strong>38</strong>分钟</p>
<h5 id="1-3s"><a href="#1-3s" class="headerlink" title="%1$3s"></a>%1$3s</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"loading"</span>&gt;</span>离下班回家还剩%1$4s分钟<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String temp = getResources().getString(R.string.loading);</span><br><span class="line">String timeTip = String.format(temp,<span class="number">38</span>);</span><br></pre></td></tr></table></figure>
<p>结果：离下班回家还剩<strong>  38</strong>分钟<br>注：m设置为4只有2个空格</p>
<h5 id="1-2-2f"><a href="#1-2-2f" class="headerlink" title="%1$2.2f"></a>%1$2.2f</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"loading"</span>&gt;</span>离下班回家还剩%1$2.2f分钟<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String temp = getResources().getString(R.string.loading);</span><br><span class="line">String timeTip = String.format(temp,<span class="number">1234.123</span>);</span><br></pre></td></tr></table></figure>
<p>结果：离下班回家还剩<strong>1234.12</strong>分钟</p>
<h4 id="的显示"><a href="#的显示" class="headerlink" title="%的显示"></a>%的显示</h4><p>使用%%来显示一个%<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"loading"</span>&gt;</span>离下班回家还剩%1$2.2f%%分钟<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String temp = getResources().getString(R.string.loading);</span><br><span class="line">String timeTip = String.format(temp,<span class="number">34.123</span>);</span><br></pre></td></tr></table></figure>
<p>结果：离下班回家还剩<strong>34.12%</strong>分钟</p>
<h4 id="空格的显示"><a href="#空格的显示" class="headerlink" title="空格的显示"></a>空格的显示</h4><h5 id="amp-8194-半个中文字"><a href="#amp-8194-半个中文字" class="headerlink" title="&amp;#8194;半个中文字"></a><code>&amp;#8194;</code>半个中文字</h5><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">string</span> <span class="attr">name</span>=<span class="string">"num"</span>&gt;</span>今日&amp;#8194;&amp;#8194;&amp;#8194;&amp;#8194;工单总数<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>结果：<br><img src="/images/string显示空格.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/21/JSON和Gson的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/21/JSON和Gson的使用/" itemprop="url">Json和Gson的使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-21T07:54:34+08:00">
                2018-01-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Json/" itemprop="url" rel="index">
                    <span itemprop="name">Json</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="泛型的使用"><a href="#泛型的使用" class="headerlink" title="泛型的使用"></a>泛型的使用</h5><p>通常使用<code>new TypeToken&lt;XXX&gt;(){}</code>来获取Type之后转换</p>
<pre><code class="java">Type type = <span class="keyword">new</span> TypeToken&lt;Subsys&lt;FireData&gt;&gt;(){}.getType();
subsys.Fire=<span class="keyword">new</span> Gson().fromJson(obj.optString(<span class="string">"Fire"</span>),type);
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/20/重构——引入Databinding/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/20/重构——引入Databinding/" itemprop="url">重构——引入Databinding</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-20T09:55:20+08:00">
                2018-01-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/重构/" itemprop="url" rel="index">
                    <span itemprop="name">重构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="添加DataBinding支持"><a href="#添加DataBinding支持" class="headerlink" title="添加DataBinding支持"></a>添加DataBinding支持</h5><p>在Android Studio上使用，需要在module级别的build.gradle上添加对DataBinding的支持<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ....</span><br><span class="line">    dataBinding &#123;</span><br><span class="line">        enabled = <span class="keyword">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="布局文件"><a href="#布局文件" class="headerlink" title="布局文件"></a>布局文件</h5><p>DataBinding的layout files和普通的非DataBinding布局文件是有一些区别的，下面是一个基础的使用了DataBinding的布局文件<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">variable</span></span></span><br><span class="line"><span class="tag">            <span class="attr">name</span>=<span class="string">"user"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"com.example.User"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">LinearLayout</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:orientation</span>=<span class="string">"vertical"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"@&#123;user.firstName&#125;"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">android:text</span>=<span class="string">"@&#123;user.lastName&#125;"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h5 id="事件处理"><a href="#事件处理" class="headerlink" title="事件处理"></a>事件处理</h5><h6 id="点击事件onClick"><a href="#点击事件onClick" class="headerlink" title="点击事件onClick"></a>点击事件<code>onClick</code></h6><p><code>android:onClick=&quot;@{()-&gt;viewModel.logout()}</code><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:id</span>=<span class="string">"@+id/log_out"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_width</span>=<span class="string">"268dp"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_height</span>=<span class="string">"32dp"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_centerHorizontal</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:layout_marginTop</span>=<span class="string">"40dp"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:onClick</span>=<span class="string">"@&#123;()-&gt;viewModel.logout()&#125;"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:background</span>=<span class="string">"@drawable/round_corner_logout"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:text</span>=<span class="string">"@string/log_out"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:textColor</span>=<span class="string">"#ffffff"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:textSize</span>=<span class="string">"14sp"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<h5 id="ViewPager"><a href="#ViewPager" class="headerlink" title="ViewPager"></a><code>ViewPager</code></h5><h6 id="setCurrentItem-int-item"><a href="#setCurrentItem-int-item" class="headerlink" title="setCurrentItem(int item)"></a><code>setCurrentItem(int item)</code></h6><ul>
<li>在ViewModel创建<code>public ObservableInt mCurrentIndex = new ObservableInt();</code></li>
<li>在xml关联<code>app:currentItem=&quot;@{viewModel.mCurrentIndex}&quot;</code></li>
<li>通过设置mCurrentIndex的值，即可改变ViewPager的显示位置<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCurrentItem</span><span class="params">(<span class="keyword">int</span> currentIndex)</span> </span>&#123;</span><br><span class="line">  mCurrentIndex.set(currentIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h6 id="setAdapter-PagerAdapter-adapter"><a href="#setAdapter-PagerAdapter-adapter" class="headerlink" title="setAdapter(PagerAdapter adapter)"></a><code>setAdapter(PagerAdapter adapter)</code></h6><ul>
<li>在ViewModel创建<code>public FragmentPagerAdapter mAdapter;</code></li>
<li>在<code>setViewModel</code>前，需要初始化<code>mAdapter</code></li>
<li>在xml关联<code>app:adapter=&quot;@{viewModel.mAdapter}&quot;</code></li>
</ul>
<h6 id="setOnPageChangeListener-OnPageChangeListener-listener"><a href="#setOnPageChangeListener-OnPageChangeListener-listener" class="headerlink" title="setOnPageChangeListener(OnPageChangeListener listener)"></a><code>setOnPageChangeListener(OnPageChangeListener listener)</code></h6><ul>
<li>在ViewModel实现接口<code>implements OnPageChangeListener</code></li>
<li><p>重写<code>OnPageChangeListener</code>的方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrollStateChanged</span><span class="params">(<span class="keyword">int</span> state)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageScrolled</span><span class="params">(<span class="keyword">int</span> position, <span class="keyword">float</span> positionOffset, <span class="keyword">int</span> positionOffsetPixels)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onPageSelected</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;</span><br><span class="line">    mCurrentIndex.set(position);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在xml关联<code>app:onPageChangeListener=&quot;@{viewModel}&quot;</code></p>
</li>
</ul>
<h5 id="View的可见状态控制"><a href="#View的可见状态控制" class="headerlink" title="View的可见状态控制"></a>View的可见状态控制</h5><ul>
<li>引入View <code>&lt;import type=&quot;android.view.View&quot; /&gt;</code></li>
<li>通过<code>?:</code>来控制显示<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:visibility="@&#123;viewModel.isVisible?View.VISIBLE:View.GONE&#125;"</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="颜色控制"><a href="#颜色控制" class="headerlink" title="颜色控制"></a>颜色控制</h5><ul>
<li>通过<code>?:</code>来控制显示<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:textColor="@&#123;viewModel.isBlue?@color/blue:@color/gray&#125;"</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="Include布局"><a href="#Include布局" class="headerlink" title="Include布局"></a>Include布局</h5><p>Include这个布局标签在DataBinding布局里面使用有点特殊, 因为它需要我们传递绑定的方法和数据对象。比如我们有以下的include布局:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">layout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">data</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">import</span> <span class="attr">type</span>=<span class="string">"android.view.View"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">variable</span></span></span><br><span class="line"><span class="tag">            <span class="attr">name</span>=<span class="string">"viewModel"</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">"com.zhhx.fragment.IbmsMainFragment"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">data</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>那么我们在另一个xml引用时,就需要传递这个include需要绑定的方法和数据:<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">include</span></span></span><br><span class="line"><span class="tag">   <span class="attr">layout</span>=<span class="string">"@layout/include_sub_system_airconditioner"</span></span></span><br><span class="line"><span class="tag">   <span class="attr">app:viewModel</span>=<span class="string">"@&#123;viewModel&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure></p>
<h5 id="ObservableField"><a href="#ObservableField" class="headerlink" title="ObservableField"></a>ObservableField</h5><p>使用ObservableField可以引用复杂的数据类型，如<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ObservableField&lt;SubsysBean&gt; subsysBean = <span class="keyword">new</span> ObservableField&lt;&gt;();</span><br></pre></td></tr></table></figure></p>
<p>在数据更新时，直接set即可，不需要对<code>SubsysBean</code>实现Bindable注解。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subsysBean.set(info);</span><br></pre></td></tr></table></figure></p>
<h5 id="Databinding自动判空"><a href="#Databinding自动判空" class="headerlink" title="Databinding自动判空"></a>Databinding自动判空</h5><p>使用时不需要判空，如：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">info.Video.getData().setObjList(<span class="keyword">null</span>);</span><br><span class="line">subsysBean.set(info);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">   <span class="attr">...</span></span></span><br><span class="line"><span class="tag">   <span class="attr">android:text</span>=<span class="string">"@&#123;String.valueOf(viewModel.subsysBean.Video.data.ObjList.get(2).ValidCount)&#125;"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>查看源码可知,虽然进行了判空，但是对数组越界没有进行处理，所以要<strong> 谨慎防止数组越界 </strong><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (viewModelSubsysBeanVideoDataGetObjList != <span class="keyword">null</span>) &#123;</span><br><span class="line">   <span class="comment">// read viewModel.subsysBean.get().Video.data.getObjList().get(1)</span></span><br><span class="line">   viewModelSubsysBeanVideoDataGetObjListGetInt1 = viewModelSubsysBeanVideoDataGetObjList.get(<span class="number">1</span>);</span><br><span class="line">   <span class="comment">// read viewModel.subsysBean.get().Video.data.getObjList().get(2)</span></span><br><span class="line">   viewModelSubsysBeanVideoDataGetObjListGetInt2 = viewModelSubsysBeanVideoDataGetObjList.get(<span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h5 id="TextView的int类型数值的显示"><a href="#TextView的int类型数值的显示" class="headerlink" title="TextView的int类型数值的显示"></a>TextView的int类型数值的显示</h5><p>直接使用int类型会报错，可以调用<code>String.valueOf()</code>方法</p>
<pre><code class="xml"><span class="tag">&lt;<span class="name">TextView</span></span>
<span class="tag">   <span class="attr">...</span></span>
<span class="tag">   <span class="attr">android:text</span>=<span class="string">"@{String.valueOf(viewModel.subsysBean.Video.data.ObjList.get(2).ValidCount)}"</span> /&gt;</span>
</code></pre>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/20/重构智慧社区遇到的问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/20/重构智慧社区遇到的问题/" itemprop="url">重构智慧社区遇到的问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-20T07:28:04+08:00">
                2018-01-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/重构/" itemprop="url" rel="index">
                    <span itemprop="name">重构</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="transformNativeLibsWithStripDebugSymbolForDebug"><a href="#transformNativeLibsWithStripDebugSymbolForDebug" class="headerlink" title="transformNativeLibsWithStripDebugSymbolForDebug"></a><code>transformNativeLibsWithStripDebugSymbolForDebug</code></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Error:Execution failed <span class="keyword">for</span> task <span class="string">':zhhxProperty:transformNativeLibsWithStripDebugSymbolForDebug'</span>.</span><br><span class="line">&gt; java.lang.NullPointerException (no error message)</span><br></pre></td></tr></table></figure>
<h6 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h6><p>将<code>compileSdkVersion 19</code>改成<code>compileSdkVersion 27</code>，即升级所有<code>module</code>的<code>compileSdkVersion</code></p>
<h5 id="Error-7-23-错误-程序包org-apache-http不存在"><a href="#Error-7-23-错误-程序包org-apache-http不存在" class="headerlink" title="Error:(7, 23) 错误: 程序包org.apache.http不存在"></a>Error:(7, 23) 错误: 程序包<code>org.apache.http</code>不存在</h5><h6 id="解决方案：-1"><a href="#解决方案：-1" class="headerlink" title="解决方案："></a>解决方案：</h6><p><code>build.gradle</code>中,在<code>buildToolsVersion</code>和<code>defaultConfig</code>之间添加如下代码<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useLibrary <span class="string">'org.apache.http.legacy'</span></span><br></pre></td></tr></table></figure></p>
<h5 id="FloatMath"><a href="#FloatMath" class="headerlink" title="FloatMath"></a>FloatMath</h5><p>Error:(117, 39) 错误: 找不到符号<br>符号:   方法 floor(float)<br>位置: 类 FloatMath</p>
<h6 id="解决方案：-2"><a href="#解决方案：-2" class="headerlink" title="解决方案："></a>解决方案：</h6><p>将<code>FloatMath.floor()</code>改成<code>Math.floor()</code></p>
<h5 id="setLatestEventInfo"><a href="#setLatestEventInfo" class="headerlink" title="setLatestEventInfo"></a><code>setLatestEventInfo</code></h5><p>Error:(403, 25) 错误: 找不到符号<br>符号:   方法 setLatestEventInfo(Context,String,String,PendingIntent)<br>位置: 类型为Notification的变量 notification</p>
<h6 id="解决方案：-3"><a href="#解决方案：-3" class="headerlink" title="解决方案："></a>解决方案：</h6><p>将<code>notification.setLatestEventInfo(context, title, message, pi);</code><br>改成<code>showNotification(pi,title,message);</code></p>
<pre><code class="java"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showNotification</span><span class="params">(PendingIntent contentIntent, String contentTitle, String contentText)</span> </span>{
    <span class="comment">//2、发布到通知栏，让监听者能点击</span>
    <span class="comment">//获取NotificationManager实例</span>
    NotificationManager notifyManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);
    <span class="comment">//实例化NotificationCompat.Builde并设置相关属性</span>
    NotificationCompat.Builder builder = <span class="keyword">new</span> NotificationCompat.Builder(<span class="keyword">this</span>)
            .setContentIntent(contentIntent)
            .setDefaults(Notification.DEFAULT_ALL)
            <span class="comment">//设置小图标</span>
            .setSmallIcon(R.mipmap.ic_launcher)
            <span class="comment">//设置通知标题</span>
            .setContentTitle(TextUtils.isEmpty(contentTitle) ? getResources().getString(R.string.app_name) : contentTitle)
            .setAutoCancel(<span class="keyword">true</span>)
            <span class="comment">//设置通知内容</span>
            .setContentText(contentText);
    <span class="comment">//通过builder.build()方法生成Notification对象,并发送通知,id=1</span>
    notifyManager.notify(<span class="number">1</span>, builder.build());
}
</code></pre>
<h5 id="找不到Frganment的getContext-方法。"><a href="#找不到Frganment的getContext-方法。" class="headerlink" title="找不到Frganment的getContext()方法。"></a>找不到Frganment的getContext()方法。</h5><p>Error:(197, 28) 错误: 找不到符号<br>符号:   方法 getContext()<br>位置: 类 ComplaintClosedFragment </p>
<h6 id="解决方法："><a href="#解决方法：" class="headerlink" title="解决方法："></a>解决方法：</h6><p>改用<code>getActivity()</code>方法。</p>
<h5 id="找不到ViewPager的addOnPageChangeListener-方法。"><a href="#找不到ViewPager的addOnPageChangeListener-方法。" class="headerlink" title="找不到ViewPager的addOnPageChangeListener()方法。"></a>找不到ViewPager的addOnPageChangeListener()方法。</h5><p>Error:(428, 23) 错误: 找不到符号<br>符号:   方法 addOnPageChangeListener(ComplaintFragment.TabOnPageChangeListener)<br>位置: 类型为ViewPager的变量 mViewPager </p>
<h6 id="解决方法：-1"><a href="#解决方法：-1" class="headerlink" title="解决方法："></a>解决方法：</h6><p>改用<code>setOnPageChangeListener()</code>方法。</p>
<h5 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h5><p>1、图片框架改造；<br><a href="http://highlightjs.readthedocs.io/en/latest/css-classes-reference.html" target="_blank" rel="noopener">http://highlightjs.readthedocs.io/en/latest/css-classes-reference.html</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/20/Android 代码规范 - 命名规范/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/20/Android 代码规范 - 命名规范/" itemprop="url">Android 代码规范 - 命名规范</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-20T07:20:00+08:00">
                2018-01-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/命名规范/" itemprop="url" rel="index">
                    <span itemprop="name">命名规范</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Layout"><a href="#Layout" class="headerlink" title="Layout"></a>Layout</h2><p>Layout的命名规则需要和使用他们的组件对应，方便查找和维护，比如我们在创建一个用户信息的<code>UserInfoActivity</code>，对应的Layout的命名就应该是<code>activity_user_info.xml</code>。对应Andorid组件的<code>Layout</code>命名规则:</p>
<ul>
<li>Activity  -&gt;   <code>activity_user_info.xml</code></li>
<li>Fragment  -&gt;   <code>fragment_sign_up.xml</code></li>
<li>Dialog    -&gt;   <code>dialog_change_password.xml</code></li>
<li>AdapterView Item  -&gt;  <code>item_user.xml</code></li>
<li>include  -&gt;    <code>include_stats_bar.xml</code></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/16/czy1121_update应用笔记(二）——Android客户端/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/16/czy1121_update应用笔记(二）——Android客户端/" itemprop="url">czy1121_update应用笔记(二）——Android客户端</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-16T19:48:44+08:00">
                2018-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/第三方库/" itemprop="url" rel="index">
                    <span itemprop="name">第三方库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近做的一个APP需要检测更新，以前都是自己写的，这次决定使用别人封装好的一个库。</p>
<p><a href="https://github.com/czy1121/update" target="_blank" rel="noopener">czy1121/update</a><br>清晰灵活简单易用的应用更新库</p>
<p>第一步，需要搭建一个检测更新的服务。详见<br><a href="https://chenzhenlindx.github.io/2018/01/16/czy1121_update%E5%BA%94%E7%94%A8%E7%AC%94%E8%AE%B0(%E4%B8%80%EF%BC%89%E2%80%94%E2%80%94%E6%90%AD%E5%BB%BA%E6%9C%8D%E5%8A%A1/" target="_blank" rel="noopener">czy1121_update应用笔记(一）——搭建服务</a></p>
<p>第二步，就是编写Android客户端代码了。</p>
<ul>
<li>创建Android工程；</li>
<li><p>导入相关的库</p>
<ul>
<li><p><a href="https://github.com/czy1121/update" target="_blank" rel="noopener">czy1121/update</a></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">repositories</span> &#123; </span><br><span class="line">   maven &#123; url <span class="string">"https://jitpack.io"</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">   implementation <span class="string">'com.github.czy1121:update:1.1.1'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://github.com/afollestad/material-dialogs" target="_blank" rel="noopener">afollestad/material-dialogs</a></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">  implementation <span class="string">'com.afollestad.material-dialogs:core:0.9.5.0'</span></span><br><span class="line">  implementation <span class="string">'com.afollestad.material-dialogs:commons:0.9.5.0'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><a href="https://github.com/Blankj/AndroidUtilCode" target="_blank" rel="noopener">Blankj/AndroidUtilCode</a></p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dependencies</span> &#123;</span><br><span class="line">  implementation <span class="string">'com.blankj:utilcode:1.9.2'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>需要设置Application并且初始化Utils</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyApplication</span> <span class="keyword">extends</span> <span class="title">Application</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">super</span>.onCreate();</span><br><span class="line">       Utils.init(<span class="keyword">this</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:name</span>=<span class="string">".MyApplication"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:allowBackup</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:icon</span>=<span class="string">"@mipmap/ic_launcher"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:label</span>=<span class="string">"@string/app_name"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:roundIcon</span>=<span class="string">"@mipmap/ic_launcher_round"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:supportsRtl</span>=<span class="string">"true"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">android:theme</span>=<span class="string">"@style/AppTheme"</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".MainActivity"</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">               <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>修改app下的build.gradle</li>
</ul>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">defaultConfig &#123;</span><br><span class="line">       applicationId <span class="string">"cn.czl.updatedemo"</span></span><br><span class="line">       minSdkVersion <span class="number">16</span></span><br><span class="line">       targetSdkVersion <span class="number">22</span></span><br><span class="line">       versionCode <span class="number">1</span></span><br><span class="line">       versionName <span class="string">"1.0"</span></span><br><span class="line">       testInstrumentationRunner <span class="string">"android.support.test.runner.AndroidJUnitRunner"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">compileOptions &#123;</span><br><span class="line">       <span class="keyword">sourceCompatibility</span> <span class="number">1.8</span></span><br><span class="line">       <span class="keyword">targetCompatibility</span> <span class="number">1.8</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>修改xml布局文件,新增一个TextView用于显示版本，新增一个Button用于主动更新</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">android.support.constraint.ConstraintLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:app</span>=<span class="string">"http://schemas.android.com/apk/res-auto"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tools</span>=<span class="string">"http://schemas.android.com/tools"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">tools:context</span>=<span class="string">"cn.czl.updatedemo.MainActivity"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/tv_version"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"Hello World!"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintBottom_toBottomOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toTopOf</span>=<span class="string">"parent"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:id</span>=<span class="string">"@+id/button"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_width</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:layout_marginTop</span>=<span class="string">"30dp"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:text</span>=<span class="string">"检查更新"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintLeft_toLeftOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintRight_toRightOf</span>=<span class="string">"parent"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">app:layout_constraintTop_toBottomOf</span>=<span class="string">"@+id/tv_version"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">android.support.constraint.ConstraintLayout</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>在MainActivity中编写更新方法，自定义下载提示框、进度框。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 根据 agent.getInfo() 显示更新版本对话框，具体可参考 &#123;<span class="doctag">@link</span> UpdateAgent.DefaultUpdatePrompter&#125;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> isManual</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">boolean</span> isManual)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 设置默认更新接口地址与渠道</span></span><br><span class="line">    UpdateManager.setUrl(<span class="string">"http://10.129.51.27:8080/app/check"</span>, <span class="string">"yyb"</span>);</span><br><span class="line">    <span class="comment">// 进入应用时查询更新</span></span><br><span class="line">    UpdateManager.create(<span class="keyword">this</span>)</span><br><span class="line">            <span class="comment">//自定义更新提示框</span></span><br><span class="line">            .setPrompter(agent -&gt; &#123;</span><br><span class="line">                UpdateInfo updateInfo = agent.getInfo();</span><br><span class="line">                String size = Formatter.formatShortFileSize(MainActivity.<span class="keyword">this</span>, updateInfo.size);</span><br><span class="line">                <span class="keyword">new</span> MaterialDialog.Builder(MainActivity.<span class="keyword">this</span>)</span><br><span class="line">                        .title(<span class="string">"应用更新"</span>)</span><br><span class="line">                        .content(R.string.update_content, updateInfo.versionName, size, updateInfo.updateContent)</span><br><span class="line">                        .negativeText(<span class="string">"以后再说"</span>)</span><br><span class="line">                        .negativeColor(getResources().getColor(R.color.blue))</span><br><span class="line">                        .positiveText(<span class="string">"立即更新"</span>)</span><br><span class="line">                        .positiveColor(getResources().getColor(R.color.blue))</span><br><span class="line">                        .onPositive((dialog, which) -&gt; agent.update())</span><br><span class="line">                        .show();</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="comment">//更新失败给出提示</span></span><br><span class="line">            .setOnFailureListener(error -&gt; ToastUtils.showShort(error.toString()))</span><br><span class="line">            <span class="comment">//设置下载进度条</span></span><br><span class="line">            .setOnDownloadListener(<span class="keyword">new</span> OnDownloadListener() &#123;</span><br><span class="line">                <span class="keyword">private</span> MaterialDialog dialog;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onStart</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    dialog = <span class="keyword">new</span> MaterialDialog.Builder(MainActivity.<span class="keyword">this</span>)</span><br><span class="line">                            .content(<span class="string">"下载中"</span>)</span><br><span class="line">                            .progress(<span class="keyword">false</span>, <span class="number">100</span>, <span class="keyword">true</span>)</span><br><span class="line">                            .cancelable(<span class="keyword">false</span>)</span><br><span class="line">                            .show();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onProgress</span><span class="params">(<span class="keyword">int</span> progress)</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (<span class="keyword">null</span> != dialog) &#123;</span><br><span class="line">                        dialog.setProgress(progress);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onFinish</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                    <span class="keyword">if</span> (dialog != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        dialog.dismiss();</span><br><span class="line">                        dialog = <span class="keyword">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">            .setManual(isManual)</span><br><span class="line">            <span class="comment">//开始更新</span></span><br><span class="line">            .check();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置网络权限ACCESS_NETWORK_STATE和INTERNET</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.ACCESS_NETWORK_STATE"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">uses-permission</span> <span class="attr">android:name</span>=<span class="string">"android.permission.INTERNET"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>-安装运行，即可看到如下2个界面：<br><img src="/images/UpdateDemo/device-2018-01-17-090844.png" alt="更新弹窗"><br><img src="/images/UpdateDemo/device-2018-01-17-091102.png" alt="下载进度"></p>
</li>
</ul>
<p>注意：<strong> 本地apk和服务器apk需要签名相同，都需要release版本才能正常更新。 </strong><br><a href="/images/UpdateDemo/apk1.0.apk">apk旧版本</a><br><a href="/images/UpdateDemo/apk2.0.apk">apk新版本</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/16/czy1121_update应用笔记(一）——搭建服务/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/16/czy1121_update应用笔记(一）——搭建服务/" itemprop="url">czy1121_update应用笔记(一）——搭建服务</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-16T18:49:27+08:00">
                2018-01-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/第三方库/" itemprop="url" rel="index">
                    <span itemprop="name">第三方库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近做的一个APP需要检测更新，以前都是自己写的，这次决定使用别人封装好的一个库。</p>
<p><a href="https://github.com/czy1121/update" target="_blank" rel="noopener">czy1121/update</a><br>清晰灵活简单易用的应用更新库</p>
<p>第一步，需要搭建一个检测更新的服务。这里直接在之前写的一个库的基础上修改。</p>
<p><a href="https://github.com/chenzhenlindx/SpringBootDemo" target="_blank" rel="noopener">chenzhenlindx/SpringBootDemo</a><br>清晰灵活简单易用的应用更新库<br>首先导入此项目，或者按照说明创建项目。</p>
<p>要实现的效果为：<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">url：http://example.com/check?package=ezy.demo.update&amp;version=123&amp;channel=yyb</span><br><span class="line">method：get</span><br><span class="line">response：</span><br><span class="line">&#123;</span><br><span class="line">	<span class="attr">"hasUpdate"</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">"isSilent"</span>: <span class="literal">false</span>,</span><br><span class="line">	<span class="attr">"isForce"</span>: <span class="literal">false</span>,</span><br><span class="line">	<span class="attr">"isAutoInstall"</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">"isIgnorable"</span>: <span class="literal">true</span>,</span><br><span class="line">	<span class="attr">"versionCode"</span>: <span class="number">2</span>,</span><br><span class="line">	<span class="attr">"versionName"</span>: <span class="string">"v2.0.2018-1-16"</span>,</span><br><span class="line">	<span class="attr">"updateContent"</span>: <span class="string">"1、修改了bug1；\r\n2、修改了bug2；\r\n3、新增了某个功能。"</span>,</span><br><span class="line">	<span class="attr">"url"</span>: <span class="string">"http://10.129.51.27:8080/apk/apk2018-1-15.apk"</span>,</span><br><span class="line">	<span class="attr">"md5"</span>: <span class="string">"34db53f031fccf92b779e0d160ef37c1"</span>,</span><br><span class="line">	<span class="attr">"size"</span>: <span class="number">1824234</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>1、在package <code>com.example.demo.domain</code>创建<code>UpdateInfo.java</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateInfo</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 是否有新版本</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> hasUpdate = <span class="keyword">false</span>;</span><br><span class="line">	<span class="comment">// 是否静默下载：有新版本时不提示直接下载</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isSilent = <span class="keyword">false</span>;</span><br><span class="line">	<span class="comment">// 是否强制安装：不安装无法使用app</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isForce = <span class="keyword">false</span>;</span><br><span class="line">	<span class="comment">// 是否下载完成后自动安装</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isAutoInstall = <span class="keyword">true</span>;</span><br><span class="line">	<span class="comment">// 是否可忽略该版本</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">boolean</span> isIgnorable = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">int</span> versionCode;</span><br><span class="line">	<span class="keyword">public</span> String versionName;</span><br><span class="line">	<span class="keyword">public</span> String updateContent;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String url;</span><br><span class="line">	<span class="keyword">public</span> String md5;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">long</span> size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>2、在<code>resources</code>目录下创建static/apk文件夹，将新版本apk复制到此目录<br><img src="/images/UpdateDemo/apk_path.png" alt=""><br>启动服务后，点击 <a href="http://10.129.51.27:8080/apk/apk2018-1-15.apk" target="_blank" rel="noopener">http://10.129.51.27:8080/apk/apk2018-1-15.apk</a> 弹窗文件下载框，表示文件位置正确。<br><img src="/images/UpdateDemo/apk_dialog.png" alt=""></p>
<p>3、创建<code>AppConttroller.java</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.math.BigInteger;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.util.ResourceUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.domain.UpdateInfo;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/app"</span>)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConttroller</span> </span>&#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * http://10.129.51.27:8080/app/check?package=cn.czl.updatedemo&amp;version=1&amp;channel=main</span></span><br><span class="line"><span class="comment">	 * </span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@throws</span> FileNotFoundException</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = <span class="string">"/check"</span>, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> UpdateInfo <span class="title">check</span><span class="params">(@RequestParam(name = <span class="string">"package"</span>, required = <span class="keyword">true</span>)</span> String pkg,</span></span><br><span class="line"><span class="function">			@<span class="title">RequestParam</span><span class="params">(name = <span class="string">"version"</span>, required = <span class="keyword">true</span>)</span> <span class="keyword">int</span> version,</span></span><br><span class="line"><span class="function">			@<span class="title">RequestParam</span><span class="params">(name = <span class="string">"channel"</span>, required = <span class="keyword">true</span>)</span> String channel) <span class="keyword">throws</span> FileNotFoundException </span>&#123;</span><br><span class="line">		UpdateInfo updateInfo = <span class="keyword">new</span> UpdateInfo();</span><br><span class="line">		<span class="keyword">if</span> (version &gt; <span class="number">1</span>) &#123;</span><br><span class="line">			updateInfo.hasUpdate = <span class="keyword">false</span>;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			updateInfo.hasUpdate = <span class="keyword">true</span>;</span><br><span class="line">			updateInfo.versionCode = <span class="number">2</span>;</span><br><span class="line">			updateInfo.versionName = <span class="string">"v2.0.2018-1-16"</span>;</span><br><span class="line">			updateInfo.updateContent = <span class="string">"1、修改了bug1；\r\n"</span> + <span class="string">"2、修改了bug2；\r\n"</span> + <span class="string">"3、新增了某个功能。"</span>;</span><br><span class="line"></span><br><span class="line">			updateInfo.url = <span class="string">"http://10.129.51.27:8080/apk/apk2018-1-15.apk"</span>;</span><br><span class="line">			File file = ResourceUtils.getFile(<span class="string">"classpath:static/apk/apk2018-1-15.apk"</span>);</span><br><span class="line">			updateInfo.md5 = md5(file);</span><br><span class="line">			updateInfo.size = file.length();</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> updateInfo;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">md5</span><span class="params">(File file)</span> </span>&#123;</span><br><span class="line">		MessageDigest digest = <span class="keyword">null</span>;</span><br><span class="line">		FileInputStream fis = <span class="keyword">null</span>;</span><br><span class="line">		<span class="keyword">byte</span>[] buffer = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">		<span class="keyword">try</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> (!file.isFile()) &#123;</span><br><span class="line">				<span class="keyword">return</span> <span class="string">""</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			digest = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">			fis = <span class="keyword">new</span> FileInputStream(file);</span><br><span class="line">			<span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">				<span class="keyword">int</span> len;</span><br><span class="line">				<span class="keyword">if</span> ((len = fis.read(buffer, <span class="number">0</span>, <span class="number">1024</span>)) == -<span class="number">1</span>) &#123;</span><br><span class="line">					fis.close();</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				digest.update(buffer, <span class="number">0</span>, len);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">			e.printStackTrace();</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		BigInteger var5 = <span class="keyword">new</span> BigInteger(<span class="number">1</span>, digest.digest());</span><br><span class="line">		<span class="keyword">return</span> String.format(<span class="string">"%1$032x"</span>, <span class="keyword">new</span> Object[] &#123; var5 &#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在浏览器访问：<br><a href="http://10.129.51.27:8080/app/check?package=cn.czl.updatedemo&amp;version=1&amp;channel=main" target="_blank" rel="noopener">http://10.129.51.27:8080/app/check?package=cn.czl.updatedemo&amp;version=1&amp;channel=main</a><br>即可得到预想的json。<br>注意：</p>
<ol>
<li>正常情况我们应该apk使用表单上传，更新信息应该从表单获取；</li>
<li>代码直接当version&gt;1判断无更新，实际上应该查询数据库最新版本进行比较；</li>
<li>md5是获取apk文件的md5，而不是打包签名文件的md5，具体的md5获取代码如上。</li>
</ol>
<p>至此，服务端代码编写完成，详情可参考<br><a href="https://github.com/chenzhenlindx/czy1121Update/tree/master/SpringBoot" target="_blank" rel="noopener">czy1121Update/SpringBoot</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/15/智慧平安社区用到的第三方库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/15/智慧平安社区用到的第三方库/" itemprop="url">智慧平安社区用到的第三方库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-15T11:44:40+08:00">
                2018-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/第三方库/" itemprop="url" rel="index">
                    <span itemprop="name">第三方库</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1、czy1121-update"><a href="#1、czy1121-update" class="headerlink" title="1、czy1121/update"></a>1、<a href="https://github.com/czy1121/update" target="_blank" rel="noopener">czy1121/update</a></h3><p>  清晰灵活简单易用的应用更新库</p>
<h3 id="2、afollestad-material-dialogs"><a href="#2、afollestad-material-dialogs" class="headerlink" title="2、afollestad/material-dialogs"></a>2、<a href="https://github.com/afollestad/material-dialogs" target="_blank" rel="noopener">afollestad/material-dialogs</a></h3><p>  A beautiful, fluid, and customizable dialogs API. </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/19/android APK 查看程序MD5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/19/android APK 查看程序MD5/" itemprop="url">android APK 查看程序MD5</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-19T14:36:02+08:00">
                2016-02-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/工具/" itemprop="url" rel="index">
                    <span itemprop="name">工具</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>为了避免注册时弄错签名，建议直接用打包出来的apk查看签名，具体如下：  </p>
<ol>
<li>将apk修改后缀为 .rar文件后解压；  </li>
<li>进入解压后的META-INF目录，该目录下会存在文件CERT.RSA  </li>
<li>在该目录下打开cmd，输入命令 ：<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keytool -printcert -file CERT.RSA</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>这里将会显示出MD5和SHA1签名。</p>
<p><img src="/images/android APK查看程序MD5.png" alt=""></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/15/Spring Boot快速入门/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="chenzhenlindx">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="chenzhenlindx的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/01/15/Spring Boot快速入门/" itemprop="url">Spring Boot快速入门</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-01-15T18:15:30+08:00">
                2016-01-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Spring-Boot/" itemprop="url" rel="index">
                    <span itemprop="name">Spring Boot</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="maven构建项目"><a href="#maven构建项目" class="headerlink" title="maven构建项目"></a>maven构建项目</h3><ol>
<li>访问<a href="http://start.spring.io/" target="_blank" rel="noopener">http://start.spring.io/</a></li>
<li>选择构建工具Maven Project、Spring Boot版本1.5.9以及一些工程基本信息，点击“Switch to the full version.”java版本选择8，可参考下图所示:<br><img src="/images/SpringBoot/start.spring.io.png" alt="start.spring.io.png"></li>
<li>点击Generate Project下载项目压缩包</li>
<li>解压后，使用eclipse，Import -&gt; Existing Maven Projects -&gt; Next -&gt;选择解压后的文件夹-&gt; Finsh，OK done!</li>
</ol>
<h3 id="项目结构介绍"><a href="#项目结构介绍" class="headerlink" title="项目结构介绍"></a>项目结构介绍</h3><p><img src="/images/SpringBoot/structure.png" alt="start.spring.io.png"></p>
<p>如上图所示，Spring Boot的基础结构共三个文件:</p>
<ul>
<li><code>src/main/java</code>  程序开发以及主程序入口</li>
<li><code>src/main/resources</code> 配置文件</li>
<li><code>src/test/java</code>  测试程序</li>
</ul>
<p>另外，spingboot建议的目录结果如下：<br>root package结构：<code>com.example.demo</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">com</span><br><span class="line">  example</span><br><span class="line">    demo</span><br><span class="line">	  Application.java	  </span><br><span class="line">	  domain</span><br><span class="line">	    Customer.java</span><br><span class="line">	    CustomerRepository.java</span><br><span class="line">	  service</span><br><span class="line">	    CustomerService.java</span><br><span class="line">	  controller</span><br><span class="line">	    CustomerController.java</span><br></pre></td></tr></table></figure></p>
<ol>
<li><code>Application.java</code> 建议放到跟目录下面,主要用于做一些框架配置</li>
<li><code>domain</code>目录主要用于实体<code>Entity</code>与数据访问层<code>Repository</code></li>
<li><code>service</code> 层主要是业务类代码</li>
<li><code>controller</code> 负责页面访问控制</li>
</ol>
<p>采用默认配置可以省去很多配置，当然也可以根据自己的喜欢来进行更改<br>最后，启动Application main方法，至此一个java项目搭建好了！</p>
<h3 id="引入web模块"><a href="#引入web模块" class="headerlink" title="引入web模块"></a>引入web模块</h3><ol>
<li><p><code>pom.xml</code>中添加支持web的模块：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>pom.xml</code>文件中默认有两个模块：<br><code>spring-boot-starter</code>：核心模块，包括自动配置支持、日志和<code>YAML</code>；<br><code>spring-boot-starter-test</code>：测试模块，包括<code>JUnit</code>、<code>Hamcrest</code>、<code>Mockito</code>。</p>
</li>
<li><p>编写<code>controller</code>内容</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldController</span> </span>&#123;</span><br><span class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Hello World"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@RestController</code>的意思就是<code>controller</code>里面的方法都以json格式输出，不用再写什么jackjson配置的了！</p>
</li>
<li>启动主程序，打开浏览器访问 <a href="http://localhost:8080/hello" target="_blank" rel="noopener">http://localhost:8080/hello</a>, 就可以看到效果了，有木有很简单！</li>
</ol>
<h3 id="如何做单元测试"><a href="#如何做单元测试" class="headerlink" title="如何做单元测试"></a>如何做单元测试</h3><p>打开的src/test/下的测试入口，编写简单的http请求来测试；使用<code>mockmvc</code>进行，利用<code>MockMvcResultHandlers.print()</code>打印出执行结果。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RunWith</span>(SpringRunner.class)</span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoApplicationTests</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> MockMvc mvc;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Before</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		mvc = MockMvcBuilders.standaloneSetup(<span class="keyword">new</span> HelloWorldController()).build();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getHello</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		mvc.perform(MockMvcRequestBuilders.get(<span class="string">"/hello"</span>)</span><br><span class="line">				.accept(MediaType.APPLICATION_JSON))</span><br><span class="line">				.andExpect(MockMvcResultMatchers.status().isOk())</span><br><span class="line">				.andDo(MockMvcResultHandlers.print()).andReturn();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="开发环境的调试"><a href="#开发环境的调试" class="headerlink" title="开发环境的调试"></a>开发环境的调试</h3><p>热启动在正常开发项目中已经很常见了吧，虽然平时开发web项目过程中，改动项目启重启总是报错；但<code>springBoot</code>对调试支持很好，修改之后可以实时生效，需要添加以下的配置：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">fork</span>&gt;</span>true<span class="tag">&lt;/<span class="name">fork</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>该模块在完整的打包环境下运行的时候会被禁用。如果你使用java-jar启动应用或者用一个特定的classloader启动，它会认为这是一个“生产环境”。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>使用spring boot可以非常方便、快速搭建项目，使我们不用关心框架之间的兼容性，适用版本等各种问题，我们想使用任何东西，仅仅添加一个配置就可以，所以使用sping boot非常适合构建微服务。</p>
<p><a href="https://github.com/chenzhenlindx/SpringBootDemo" target="_blank" rel="noopener">github</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="chenzhenlindx" />
            
              <p class="site-author-name" itemprop="name">chenzhenlindx</p>
              <p class="site-description motion-element" itemprop="description">Android开发者</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">chenzhenlindx</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>





        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>